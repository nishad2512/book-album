<%- include('partials/header.ejs') %>
<!-- Search Bar -->
<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <form method="get" action="/" class="d-flex">
        <input
          type="text"
          name="search"
          class="form-control form-control-lg rounded-pill shadow-sm px-4"
          placeholder="Search books, authors, or genres..."
          value="<%= typeof search !== 'undefined' ? search : '' %>"
          style="font-size: 1rem;"
        >
        <button
          type="submit"
          class="btn btn-primary btn-lg ms-3 rounded-pill px-4 shadow-sm"
          style="font-size: 1rem;"
        >
          <i class="bi bi-search"></i> Search
        </button>
      </form>
    </div>
  </div>
</div>
  <!-- Hero Section -->
  <section class="py-5 text-center container">
    <div class="row py-lg-5">
      <div class="col-lg-6 col-md-8 mx-auto">
        <% if(locals.admin) { %>
          <h1 class="fw-light">Hi Nishad</h1>
        <% } else { %>
          <h1 class="fw-light">My Readings</h1>
        <% } %>
      </div>
    </div>
  </section>
  <!-- Sorting Option -->
  <div class="container mb-4">
    <form method="get" action="/" class="d-flex justify-content-end">
      <label for="sort" class="me-2 align-self-center">Sort by:</label>
      <select name="sort" id="sort" class="form-select w-auto me-2" onchange="this.form.submit()">
        <option value="">Select</option>
        <option value="Fiction">Fiction</option>
        <option value="Romance">Romance</option>
      </select>
      <noscript><button type="submit" class="btn btn-primary btn-sm">Sort</button></noscript>
    </form>
  </div>
  <!-- Album Grid -->
  <div class="album py-6 bg-light">
    <div class="container">
      <div class="row row-cols-1 row-cols-sm-1 row-cols-md-4 g-3">
        <!-- Card 1 -->
         <% books.forEach((book) => { %>
            <div class="col" onclick="location.href='/view/<%= book.id %>'">
                <div class="card shadow-sm">
                    <img src="<%= book.url %>" alt="" class="bd-placeholder-img card-img-top" width="100%" height="350">
                    <div class="card-body">
                        <h3><%= book.name %></h3>
                        <small class="text-muted"><%= book.author %></small>
                        <div class="mb-2">
                          <% for(let i = 1; i <= 5; i++) { %>
                            <i class="bi bi-star<%= i <= book.rating ? '-fill' : '' %> text-warning"></i>
                          <% } %>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="btn-group">
                              <% if(locals.admin) { %>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"><a href="/edit/<%= book.id %>">Edit</a></button>
                              <% } else { %>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"><a href="/view/<%= book.id %>">View</a></button>
                              <% }  if(locals.admin) {  %>
                                    <button type="button" class="btn btn-sm btn-outline-danger"><a href="/delete/<%= book.id %>">Delete</a></button>
                              <% } %> 
                            </div>
                            <small class="text-muted"><%= book.genre %></small>
                        </div>
                    </div>
                </div>
            </div>
        <% }) %>
      </div>
    </div>
  </div>
<% if (locals.admin) { %>
  <div class="text-center my-4">
      <a href="/add"><button class="btn btn-light fs-5 btn-lg button-rad" style="width: 90%;">Add books</button></a>
  </div>
<% } %>


<%- include('partials/footer.ejs') %>